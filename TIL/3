// ğŸ“ massive-todo-ai-sorter.js

/**
 * ëª©í‘œ: 500ì¤„ ì´ìƒì˜ ì§€ë¦¬ëŠ” ë¡œì§ ë§Œë“¤ê¸° (ë²„ì „ 2)
 * ì£¼ì œ: ëŒ€ê·œëª¨ íˆ¬ë‘ ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œ with AI ì˜ˆì¸¡ ë¡œì§ + ë¡œì»¬ ì‹œë®¬ë ˆì´ì…˜
 */

// ------------------------------
// SECTION 1: ìœ í‹¸ í•¨ìˆ˜ ëª¨ìŒ
// ------------------------------
function generateId() {
  return Math.random().toString(36).substr(2, 9);
}

function getToday() {
  return new Date().toISOString().split("T")[0];
}

function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function delay(ms) {
  return new Promise((res) => setTimeout(res, ms));
}

// ------------------------------
// SECTION 2: Task í´ë˜ìŠ¤ ì •ì˜
// ------------------------------
class Task {
  constructor(title, category = "general", estimatedMin = 30, dueDate = null, priority = 3) {
    this.id = generateId();
    this.title = title;
    this.category = category;
    this.estimatedMin = estimatedMin;
    this.dueDate = dueDate;
    this.priority = priority;
    this.completed = false;
    this.createdAt = new Date().toISOString();
  }

  isOverdue() {
    if (!this.dueDate) return false;
    const today = new Date(getToday());
    return new Date(this.dueDate) < today;
  }

  score() {
    const urgency = this.isOverdue() ? 5 : this.dueDate ? 3 : 0;
    return this.priority * 2 + urgency + Math.floor(100 / (this.estimatedMin + 1));
  }
}

// ------------------------------
// SECTION 3: TaskManager ëŒ€ê·œëª¨ ë¡œì§
// ------------------------------
class TaskManager {
  constructor() {
    this.tasks = [];
  }

  addTask(task) {
    this.tasks.push(task);
  }

  bulkAdd(count = 100) {
    const categories = ["work", "life", "health", "hobby", "study"];
    for (let i = 0; i < count; i++) {
      const title = `Task ${i + 1}`;
      const category = categories[randomInt(0, categories.length - 1)];
      const est = randomInt(15, 120);
      const due = Math.random() > 0.7 ? getToday() : null;
      const priority = randomInt(1, 5);
      const t = new Task(title, category, est, due, priority);
      this.addTask(t);
    }
  }

  completeTaskById(id) {
    const t = this.tasks.find((task) => task.id === id);
    if (t) t.completed = true;
  }

  getPendingTasks() {
    return this.tasks.filter((t) => !t.completed);
  }

  getSortedTasks() {
    return [...this.getPendingTasks()].sort((a, b) => b.score() - a.score());
  }

  printSummary() {
    const total = this.tasks.length;
    const completed = this.tasks.filter((t) => t.completed).length;
    const overdue = this.tasks.filter((t) => t.isOverdue()).length;
    console.log(`ì´ ì‘ì—… ìˆ˜: ${total}`);
    console.log(`ì™„ë£Œëœ ì‘ì—…: ${completed}`);
    console.log(`ë§ˆê°ì¼ ì§€ë‚œ ì‘ì—…: ${overdue}`);
  }

  async simulateProcessing(limit = 10) {
    const sorted = this.getSortedTasks();
    console.log(`\nğŸ” ìƒìœ„ ${limit}ê°œ ì‘ì—… ìˆ˜í–‰ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘`);
    for (let i = 0; i < Math.min(limit, sorted.length); i++) {
      const task = sorted[i];
      console.log(`\nâ–¶ï¸ [${task.title}] ì‹œì‘ (ì˜ˆìƒ ì‹œê°„: ${task.estimatedMin}ë¶„)`);
      await delay(100);
      this.completeTaskById(task.id);
      console.log(`âœ… [${task.title}] ì™„ë£Œë¨!`);
    }
  }
}

// ------------------------------
// SECTION 4: ì‹¤í–‰
// ------------------------------
(async () => {
  const manager = new TaskManager();
  manager.bulkAdd(300); // 300ê°œ ì‘ì—… ìƒì„±
  manager.printSummary();

  console.log("\nğŸ“‹ ìƒìœ„ ì¤‘ìš” ì‘ì—… ë¯¸ë¦¬ë³´ê¸°:");
  manager.getSortedTasks()
    .slice(0, 5)
    .forEach((t, i) => {
      console.log(`${i + 1}. ${t.title} [score: ${t.score()}]`);
    });

  await manager.simulateProcessing(20); // ìƒìœ„ 20ê°œ ì‹œë®¬ë ˆì´ì…˜

  console.log("\nğŸ§¾ ìµœì¢… ìš”ì•½:");
  manager.printSummary();
})();
